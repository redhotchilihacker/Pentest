### DOMAIN INFO ###


# Basic domain info
  > Get-NetDomain
  > Get-NetDomain -Domain mydomain.local
  
# Get DomainSID
  > Get-DomainSID
  
# Get info about the policy
  > Get-DomainPolicy
  
# Kerberos tickets info(MaxServiceAge)
  > (Get-DomainPolicy)."KerberosPolicy"
  
# Password policy
  > (Get-DomainPolicy)."SystemAccess"
  
# Get Domain Controller
  > Get-NetDomainController -Domain mydomain.local
  
  
  
  ### USERS, GROUPS, COMPUTERS ###
  
  
# Get users with several properties
  > Get-NetUser
  
# Get info about a spesific user
  > Get-NetUser -UserName user_name
  
# All enabled users
  > Get-NetUser -UACFilter NOT_ACCOUNTDISABLE -properties distinguishedname

# All disabled users
  > Get-NetUser -UACFilter ACCOUNTDISABLE
  
# ASREPRoastable users
  > Get-NetUser -PreauthNotRequired

# Kerberoastable users
  > Get-NetUser -SPN | select serviceprincipalname
  
# Domain admins kerberoastable
  > Get-NetUser -SPN | ?{$_.memberof -match 'Domain Admins'}
  
# All privileged users that aren't marked as sensitive/not for delegation
  > Get-NetUser -AllowDelegation -AdminCount
  
  
# Get groups
  > Get-NetGroup
  
# Get groups for a spesific domain
  > Get-NetGroup -Domain mydomain.local

# Get all the data from a group
  > Get-NetGroup 'Domain Admins'
  
# Search Admin Groups
  > Get-NetGroup -AdminCount

# Get groups of a user
  > Get-NetGroup -UserName user_name

# Get users inside "Administrators" group
  > Get-NetGroupMember -Identity "Administrators" -Recurse    //recurse will bring back if there's groups underneath the "Administrators" group.
  
# Get Enterprise Admins
  > Get-NetGroupMember -Identity "Enterprise Admins" -Domain mydomain.local     //This group only exists in the rootdomain of the forest.
  
# Get users of localgroup in computer
  > Get-NetLocalGroupMember -computername dcorp-dc.dollarcorp.moneycorp.local
 
 #Get restricted groups
  > Get-NetGPOGroup


# Get all computer objects
  > Get-NetCOmputer

# Send a ping to check if the computers are working
  > Get-NetComputer -Ping

# Find computers to perform uncontrained delegation
  > Get-NetComputer -Unconstrained //DC always appear but it's worth to check
  
  
### SHARED FILES AND FOLDERS ###


# Search file servers
  > Get-NetFileServer // Lot of users use to be logged in this kind of servers
  
# Search readable shares
  > Find-DomainShare -CheckShareAccess
  
# Find interesting files
  > Find-InterestingDomainShareFile
  

### GPO's (Group Policy Objects) & OU's (Organizational Units) ###


# Get all policies with details
  > Get-NetGPO //can be filter
  
# Get the policy applied in a computer
  > Get-NetGPO -ComputerName <name>

# Get current policy
  > gpresult /V
  
# Get Organization Units
  > Get-NetOU
  
  
### ACL (Access Control Lists) ###


# Get ACLs of an object
  > Get-ObjectAcl -SamAccountName user_name -ResolveGUIDs // permissions of other objects over the indicated one
  
# Get permission of a file
  > Get-PathAcl -Path "\\dc.mydomain.local\sysvol"
  
#Find interesting Access Control Lists(ACL)
  > Invoke-ACLScanner -ResolveGUIDs | select IdentityReferenceName, ObjectDN, ActiveDirectoryRights | fl



### UNFINISHED ###
  
#Get members from Domain Admins (default) and a list of computers and check if any of the users is logged in any machine running Get-NetSession/Get-NetLoggedon on each host. If -Checkaccess, then it also check for LocalAdmin access in the hosts.
  > Invoke-UserHunter -CheckAccess
  
 #Search readable shares
  > Find-DomainShare -CheckShareAccess
  
 
  
  
